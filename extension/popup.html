<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zero Knowledge Vault</title>
    <link rel="stylesheet" href="styles/popup.css" />
  </head>
  <body>
    <main class="wrapper">
      <header>
        <h1>Zero Knowledge Vault</h1>
        <p>Everything stays encrypted on your machine before it hits the server.</p>
      </header>

      <div class="popup-body">
        <div id="status" class="status" role="alert" aria-live="polite"></div>

        <section id="auth-section">
          <form id="auth-form">
            <label for="username">Username</label>
            <input id="username" name="username" autocomplete="username" required />

            <label for="password">Master password</label>
            <input
              id="password"
              name="password"
              type="password"
              autocomplete="current-password"
              required
            />

          <div class="remember-password">
            <label class="remember-toggle">
              <input type="checkbox" id="remember-password" />
              <span class="remember-switch" aria-hidden="true"></span>
              <span class="remember-label">Remember password on this device</span>
            </label>
          </div>

            <div class="form-actions">
              <button type="submit" id="login-btn" class="primary">Log in</button>
              <button type="button" id="register-btn" class="secondary">Register</button>
            </div>
          </form>
        </section>

        <section id="vault-section" hidden>
          <div class="vault-header">
            <div>
              <strong>Signed in as</strong> <span id="current-user"></span>
            </div>
            <button id="logout-btn">Log out</button>
          </div>

          <div class="auto-lock-settings">
            <label>Auto-lock timeout</label>
            <div class="auto-lock-summary">
              <span>
                <strong id="auto-lock-value">15</strong> minutes
              </span>
              <button
                type="button"
                id="auto-lock-modal-btn"
                class="icon-btn"
                aria-label="Open auto-lock settings"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path
                    d="M12 8a4 4 0 1 0 0 8 4 4 0 0 0 0-8zm8.7 4a6.6 6.6 0 0 0-.3-1.5l2.1-1.6-2-3.5-2.3.8a6.2 6.2 0 0 0-1.3-.8L16 2h-4l-.8 2.5a6.2 6.2 0 0 0-1.3.8l-2.3-.8-2 3.5 2.1 1.6a6.6 6.6 0 0 0-.3 1.5 6.6 6.6 0 0 0 .3 1.5l-2.1 1.6 2 3.5 2.3-.8c.4.3.9.5 1.3.8L12 22h4l.8-2.5c.5-.3.9-.5 1.3-.8l2.3.8 2-3.5-2.1-1.6c.2-.5.3-1 .3-1.5z"
                  ></path>
                </svg>
              </button>
            </div>
            <small>Stay signed in until the timer expires or you explicitly log out.</small>
          </div>

          <div id="pending-prompt" class="pending-prompt" aria-live="polite" hidden></div>

          <div class="shared-vaults-panel">
            <div class="shared-vaults-header">
              <h3>Shared vaults</h3>
              <p>Select a vault to start sharing entries with your team.</p>
            </div>
            <div id="shared-vault-status" class="shared-vault-status"></div>
            <div id="shared-vault-list" class="shared-vault-list"></div>
            <p id="shared-vault-empty" class="shared-vault-empty">No shared vaults yet.</p>
          </div>

          <div id="entries" class="entries"></div>

          <div class="entry-cta">
            <button
              type="button"
              id="open-entry-modal-btn"
              class="icon-btn plus-btn"
              aria-label="Add or update a login"
            >
              <span aria-hidden="true">+</span>
            </button>
            <span>Add or manage logins</span>
          </div>
        </section>
      </div>
      <div class="modal-overlay" id="auto-lock-modal" hidden>
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="auto-lock-modal-title">
          <div class="modal-header">
            <h3 id="auto-lock-modal-title">Auto-lock timeout</h3>
            <button type="button" class="icon-btn close-btn" id="auto-lock-modal-close" aria-label="Close">
              ×
            </button>
          </div>
          <p>Choose how long you stay signed in before the vault locks automatically.</p>
          <label for="auto-lock-input">Timeout</label>
          <div class="modal-input-row">
            <input
              id="auto-lock-input"
              type="number"
              min="1"
              max="60"
              step="1"
              aria-label="Auto-lock timeout in minutes"
            />
            <span>minutes</span>
          </div>
          <small>Adjusting this will override the default auto-lock duration.</small>
          <div class="modal-actions">
            <button type="button" class="secondary" id="auto-lock-modal-cancel">Cancel</button>
            <button type="button" id="auto-lock-save-btn" class="primary">Save changes</button>
          </div>
        </div>
      </div>
      <div class="modal-overlay" id="entry-modal" hidden>
        <div class="modal entry-modal" role="dialog" aria-modal="true" aria-labelledby="entry-modal-title">
          <div class="modal-header">
            <h3 id="entry-modal-title">Add / update a login</h3>
            <button type="button" class="icon-btn close-btn" id="entry-modal-close" aria-label="Close">
              ×
            </button>
          </div>
          <form id="entry-form">
            <label for="entry-label">Label</label>
            <input id="entry-label" name="label" required />

            <label for="entry-username">Username</label>
            <input id="entry-username" name="entry-username" />

            <label for="entry-password">Password</label>
            <input id="entry-password" name="entry-password" type="password" />
            <div class="password-controls">
              <button type="button" id="generate-password-btn">Generate strong</button>
              <button type="button" id="copy-entry-password-btn">Copy password</button>
            </div>

            <label for="entry-notes">Notes</label>
            <textarea id="entry-notes" name="entry-notes" rows="2"></textarea>

            <label for="entry-url">Site URL</label>
            <input id="entry-url" name="entry-url" type="url" placeholder="https://example.com" />

            <label for="entry-otp-secret">OTP secret (optional)</label>
            <div class="otp-input-row">
              <input
                id="entry-otp-secret"
                name="entry-otp-secret"
                type="text"
                placeholder="Base32 secret (A-Z2-7)"
              />
              <button type="button" id="scan-otp-btn" class="secondary">Scan QR</button>
            </div>
            <small>Enter the base32 secret to generate a TOTP within the extension.</small>

            <div class="entry-form-actions">
              <button type="submit" id="save-entry-btn" class="primary">Save encrypted vault</button>
              <button type="button" id="cancel-edit-btn" class="secondary" hidden>Cancel edit</button>
            </div>
          </form>
        </div>
      </div>
    </main>
    <script type="module" src="scripts/popup.js"></script>
  </body>
</html>
